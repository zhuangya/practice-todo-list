{"version":3,"sources":["Input.tsx","todo-fsm.ts","useTodo.ts","TodoMvc.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Input","onAppend","ref","useRef","TextField","inputRef","inputProps","onKeyDown","event","key","current","value","label","fullWidth","type","id","todoListMachine","createMachine","initial","context","list","filter","states","loaded","on","APPEND_TODO","actions","assign","ctx","action","concat","content","uuid","isCompleted","TOGGLE_TODO","map","todoItem","UPDATE_TODO","REMOVE_TODO","CLEAR_COMPLETED","SET_FILTER","_","service","interpret","identifyByFilter","status","todo","Error","UpdateBox","handleUpdate","useState","isEditting","setIsEditting","newTodo","setNewTodo","onChange","e","target","onDoubleClick","TodoMvc","useEffect","start","subscribe","state","changed","setTodoList","stop","todoList","dispatch","send","getTodoListByFilter","getTodoById","find","appendTodo","toggleTodo","clearCompleted","updateTodo","getActiveTodoCount","length","removeTodo","setFilter","filters","useTodo","Divider","List","ListItem","Checkbox","checked","Button","onClick","App","Container","Typography","align","display","variant","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.cf927116.chunk.js","sourcesContent":["import { FC, KeyboardEvent, useRef } from \"react\";\nimport { TextField } from \"@material-ui/core\";\n\nexport const Input: FC<{ onAppend?: (content: string) => void }> = ({\n  onAppend,\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n\n  return (\n    <TextField\n      inputRef={ref}\n      inputProps={{\n        onKeyDown: (event: KeyboardEvent<HTMLInputElement>) => {\n          if (\n            event.key === \"Enter\" &&\n            ref.current !== null &&\n            ref.current.value !== \"\"\n          ) {\n            onAppend && onAppend(ref.current.value);\n            ref.current.value = \"\";\n          }\n        },\n      }}\n      label=\"What needs to be done?\"\n      fullWidth\n      type=\"text\"\n      id=\"new-todo-input\"\n    />\n  );\n};\n","import { interpret, assign, createMachine } from \"@xstate/fsm\";\nimport { v4 as uuid } from \"uuid\";\nimport {\n  IStatus,\n  IAppendEvent,\n  ITodoList,\n  ITodoItem,\n  IUpdateEvent,\n  IMachineEvent,\n  IToggleEvent,\n} from \"./types\";\n\nfunction buildTodoItem(content: string): ITodoItem {\n  return {\n    id: uuid(),\n    content,\n    isCompleted: false,\n  };\n}\n\ntype ITodoListContext = {\n  list: ITodoList;\n  filter: IStatus;\n};\n\ntype ITodoState = {\n  value: \"loaded\";\n  context: {\n    list: ITodoList;\n    filter: IStatus;\n  };\n};\n\nexport const todoListMachine = createMachine<\n  ITodoListContext,\n  IMachineEvent,\n  ITodoState\n>({\n  id: \"todo-list\",\n  initial: \"loaded\",\n  context: {\n    list: [] as ITodoList,\n    filter: \"all\",\n  },\n  states: {\n    loaded: {\n      on: {\n        APPEND_TODO: {\n          actions: [\n            assign({\n              list: (ctx, action: IAppendEvent) =>\n                ctx.list.concat(buildTodoItem(action.content)),\n            }),\n          ],\n        },\n        TOGGLE_TODO: {\n          actions: [\n            assign({\n              list: (\n                ctx,\n                action: IToggleEvent // TODO: refactor this as look up table.\n              ) =>\n                ctx.list.map((todoItem) =>\n                  todoItem.id === action.id\n                    ? {\n                        ...todoItem,\n                        isCompleted: !todoItem.isCompleted,\n                      }\n                    : todoItem\n                ),\n            }),\n          ],\n        },\n        UPDATE_TODO: {\n          actions: [\n            assign({\n              list: (ctx, action: IUpdateEvent) =>\n                ctx.list.map((todoItem) =>\n                  todoItem.id === action.id\n                    ? {\n                        ...todoItem,\n                        content: action.content,\n                      }\n                    : todoItem\n                ),\n            }),\n          ],\n        },\n        REMOVE_TODO: {\n          actions: [\n            assign({\n              list: (ctx, action) =>\n                ctx.list.filter(({ id }) => action.id !== id),\n            }),\n          ],\n        },\n        CLEAR_COMPLETED: {\n          actions: [\n            assign({\n              list: (ctx) => ctx.list.filter(({ isCompleted }) => !isCompleted),\n            }),\n          ],\n        },\n        SET_FILTER: {\n          actions: [\n            assign({\n              filter: (_, action) => action.filter,\n            }),\n          ],\n        },\n      },\n    },\n  },\n});\n\nexport const service = interpret(todoListMachine);\n","import { useEffect, useState } from \"react\";\nimport { service } from \"./todo-fsm\";\n\nimport type { ITodoItem, ITodoList, IStatus } from \"./types\";\n\nconst identifyByFilter = (status: IStatus) => (todo: ITodoItem) => {\n  if (status === \"all\") {\n    return true;\n  } else if (status === \"completed\") {\n    return todo.isCompleted;\n  } else if (status === \"active\") {\n    return !todo.isCompleted;\n  } else {\n    throw new Error(\"invalid todo filter\");\n  }\n};\n\nexport function useTodo() {\n  useEffect(() => {\n    service.start();\n    service.subscribe((state) => {\n      if (state.changed) {\n        setTodoList(\n          state.context.list.filter(identifyByFilter(state.context.filter))\n        );\n      }\n    });\n    return () => {\n      service.stop();\n    };\n  }, []);\n\n  const [todoList, setTodoList] = useState<ITodoList>([] as ITodoList);\n\n  const dispatch = service.send;\n\n  function appendTodo(content: string) {\n    dispatch({\n      type: \"APPEND_TODO\",\n      content,\n    });\n  }\n\n  function updateTodo(todo: ITodoItem) {\n    dispatch({\n      type: \"UPDATE_TODO\",\n      id: todo.id,\n      content: todo.content,\n    });\n  }\n\n  function toggleTodo(id: string) {\n    dispatch({ type: \"TOGGLE_TODO\", id });\n  }\n\n  function clearCompleted() {\n    dispatch({ type: \"CLEAR_COMPLETED\" });\n  }\n\n  function getTodoListByFilter(status: IStatus = \"all\") {\n    return service.state.context.list.filter(identifyByFilter(status));\n  }\n\n  function getTodoById(id: string) {\n    return service.state.context.list.find((todo) => todo.id === id);\n  }\n\n  function getActiveTodoCount() {\n    return getTodoListByFilter(\"active\").length;\n  }\n\n  function removeTodo(id: string) {\n    dispatch({ type: \"REMOVE_TODO\", id });\n  }\n\n  function setFilter(filter: IStatus) {\n    dispatch({ type: \"SET_FILTER\", filter });\n  }\n\n  return {\n    todoList,\n    getTodoById,\n    appendTodo,\n    toggleTodo,\n    clearCompleted,\n    getTodoListByFilter,\n    updateTodo,\n    getActiveTodoCount,\n    removeTodo,\n    setFilter,\n    filters: [\"all\", \"active\", \"completed\"] as Array<IStatus>,\n  };\n}\n","import { FC, KeyboardEvent, useState } from \"react\";\nimport { Input } from \"./Input\";\nimport { useTodo } from \"./useTodo\";\nimport { Button, Divider, List, ListItem, Checkbox } from \"@material-ui/core\";\nimport { ITodoItem } from \"./types\";\n\nconst UpdateBox: FC<{\n  todo: ITodoItem;\n  handleUpdate: (todo: ITodoItem) => void;\n}> = ({ todo, handleUpdate }) => {\n  const [isEditting, setIsEditting] = useState(() => false);\n  const [newTodo, setNewTodo] = useState(() => todo.content);\n\n  return (\n    <>\n      {isEditting ? (\n        <input\n          value={newTodo}\n          onChange={(e) => setNewTodo(e.target.value)}\n          onKeyDown={(event: KeyboardEvent<HTMLInputElement>) => {\n            if (event.key === \"Escape\") {\n              setIsEditting(false);\n            } else if (event.key === \"Enter\") {\n              handleUpdate({\n                ...todo,\n                content: newTodo,\n              });\n              setIsEditting(false);\n            }\n          }}\n        />\n      ) : (\n        <span\n          onDoubleClick={() => {\n            setIsEditting(true);\n          }}\n        >\n          {todo.content}\n        </span>\n      )}\n    </>\n  );\n};\n\nexport function TodoMvc() {\n  const {\n    todoList,\n    setFilter,\n    filters,\n    toggleTodo,\n    appendTodo,\n    getActiveTodoCount,\n    clearCompleted,\n    removeTodo,\n    updateTodo,\n  } = useTodo();\n\n  return (\n    <>\n      <Input onAppend={(content) => appendTodo(content)} />\n\n      <Divider />\n\n      <List>\n        {todoList.map((todo) => (\n          <ListItem key={todo.id}>\n            <Checkbox\n              checked={todo.isCompleted}\n              onChange={() => toggleTodo(todo.id)}\n            />\n            <UpdateBox todo={todo} handleUpdate={updateTodo} />\n            <Button onClick={() => removeTodo(todo.id)}> x </Button>\n          </ListItem>\n        ))}\n      </List>\n\n      {filters.map((filter) => (\n        <Button key={filter} onClick={() => setFilter(filter)}>\n          {filter}\n        </Button>\n      ))}\n\n      <p> {getActiveTodoCount() + \" active todo(s).\"} </p>\n\n      <Button onClick={() => clearCompleted()}>Clear</Button>\n    </>\n  );\n}\n","import { Typography, Container } from \"@material-ui/core\";\nimport { TodoMvc } from \"./TodoMvc\";\n\nexport default function App() {\n  return (\n    <Container>\n      <Typography align=\"center\" display=\"block\" variant=\"h1\">\n        todo\n      </Typography>\n\n      <TodoMvc />\n\n      <Typography align=\"center\" display=\"block\" variant=\"body2\">\n        &copy; 2021\n      </Typography>\n    </Container>\n  );\n}\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <CssBaseline />\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}